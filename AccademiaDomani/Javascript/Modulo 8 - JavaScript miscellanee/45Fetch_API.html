<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body onload="caricaFile()">
    
    <script>
        //Fetch API
        //per maneggiare le promise
        function caricaFile(){
            return fetch(`https://api.coinmarketcap.com/v1/ticket/${coin}/`)
        }

       /* function caricaFile(coin){
            return new Promise((resolve, reject) =>{
                xhttp.open('GET',`https://api.coinmarketcap.com/v1/ticket/`, true)
                xhttp.send();

                xhttp.onreadystatechange = function(){
                    if (this.readyState === 4 && this.status === 200){
                        resolve(this.responseText);
                    } else if (this.status === 404) {
                        reject(new Error(this.statusText));
                    }
                };
                xhttp.onerror= function(){
                    reject(new Error(this.statusText));
                }
                
            });
        }
        */
       
        async function convertiJson(){
            //non serve catch
            const btc = await caricaFile('bitcoin');
            console.log(btc);
            let dati = await btc.json(); //per visualizzare il valore di dati
            console.log(dati);//ora si visualzza grz al codice precedente
            
            const eth = await caricaFile('etherium')
            dati = await eth.json();
            console.log(dati);

            const xrp =  await caricaFile('ripple');
            dati = await xrp.json();
            console.log(dati);
        }       



    </script>
</body>
</html>